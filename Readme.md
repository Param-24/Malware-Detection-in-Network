# Network Malware Classification

## Overview

As IoT devices proliferate, they are increasingly targeted by malware. This project implements machine learning models to classify network traffic data from IoT devices, distinguishing between benign and malicious activities. We compare the performance of two classifiers: **Random Forest** and **Support Vector Classifier (SVC)**.

## Table of Contents

- [Introduction](#introduction)
- [Dataset](#dataset)
- [Models](#models)
- [Installation](#installation)
- [Usage](#usage)
- [Training Process](#training-process)
- [Performance Evaluation](#performance-evaluation)
- [Results](#results)

## Introduction

With the rise of IoT devices, network security becomes crucial. This project aims to enhance detection methods for malicious traffic using machine learning techniques. By analyzing network traffic data, we can identify potential threats in real-time.

## Dataset

The dataset is derived from the **CTU-IoT Malware Capture** project, consisting of labeled network traffic data. Link to the dataset isÂ [Network Malware Detection Connection Analysis](https://www.kaggle.com/datasets/agungpambudi/network-malware-detection-connection-analysis). The features include:

- **Network Protocol**: Type of protocol used (e.g., TCP, UDP)
- **Service**: Network service being used (e.g., HTTP, FTP)
- **Connection State**: Current state of the connection (e.g., established, closed)
- **Traffic Volume**: Number of packets and bytes transmitted

The dataset is split into two classes:
- **Malicious**: Represents malicious activities.
- **Benign**: Represents normal traffic.

## Models

### Random Forest Classifier

- An ensemble learning method that operates by constructing multiple decision trees during training and outputting the mode of their predictions.

### Support Vector Classifier (SVC)

- A linear classifier that finds the optimal hyperplane to separate classes in a high-dimensional space.
## Installation

To run this project, ensure you have Python 3.x and the necessary libraries installed. You can set up your environment using the following command:

```bash
pip install pandas numpy scikit-learn joblib
```

## Usage

1. **Clone the Repository**:
	```bash
	git clone https://github.com/yourusername/iot-malware-classification.git 
	cd iot-malware-classification
	```
    
2. **Prepare the Dataset**: Ensure the dataset files are in the `Dataset/` directory, or update the paths in the code accordingly. Link to the dataset is https://www.kaggle.com/datasets/agungpambudi/network-malware-detection-connection-analysis.
    
3. **Open Jupyter Notebook**  
    Start Jupyter Notebook by running:
```bash
    jupyter lab
```    
    
4. **Run the Notebooks**
    - Open `random_forest_model.ipynb` to train and evaluate the Random Forest model.
    - Open `svm_model.ipynb` to train and evaluate the Support Vector Classifier model.
    
5. **Evaluate Performance**  
    Each notebook includes sections for training the model, making predictions, and displaying performance metrics (accuracy, precision, recall, F1-score).
    
6. **Save Models**  
    The trained models will be saved as `rf_model.pkl` and `svm_model.pkl` in the `models/` directory for future use.

## Training Process

### Data Preprocessing

- **Data Loading**: Read multiple CSV files and concatenate them into a single DataFrame.
- **Feature Engineering**:
    - Drop unnecessary columns.
    - Convert categorical variables into dummy/indicator variables.
    - Replace placeholder values (e.g., `'-'`) with zeros.
- **Normalization**: Scale features using `StandardScaler` to ensure uniformity in the input data.

### Model Training

- **Random Forest**:
    - Fit the model using the training dataset.
    - Save the model using `joblib` for future use.
- **Support Vector Classifier**:
    - Fit the model with specified hyperparameters.
    - Save the model for later evaluation.

## Performance Evaluation

Performance metrics for each model include:

- **Accuracy**: The ratio of correctly predicted instances to the total instances.
- **Precision**: The ratio of true positive predictions to the total predicted positives.
- **Recall**: The ratio of true positive predictions to the actual positives.
- **F1-Score**: The harmonic mean of precision and recall.

These metrics help assess the model's effectiveness in distinguishing between benign and malicious traffic.

## Results

### Sample Performance Metrics

- **Random Forest Classifier**:
    - Accuracy: 85.77%
    - Classification Report:
		```
			precision  recall  f1-score   support

		       0       0.86      1.00      0.92    816996
		       1       0.99      0.02      0.04    138993
	       
			accuracy                       0.86    955989
		```

        
- **Support Vector Classifier**:
    - Accuracy: 98.94%
    - Classification Report:
        ```
			precision  recall  f1-score   support
        
		       0       1.00      0.99      0.99    816996
		       1       0.94      0.99      0.96    138993

			accuracy                       0.99    955989
		```
		
